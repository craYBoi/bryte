{% extends "base.html" %}
{% load staticfiles %}

{% block stylesheet %}
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/animate.css/3.2.0/animate.min.css">
  <link rel="stylesheet" type="text/css" href="{% static 'css/magnifier.css' %}">
{% endblock %}

{% block content %}

	<!-- retrieve page -->
	
	{% if not headshots %}

		<div class="red_bg center_flex" style="height:75vh;">
			<h1 class="white">The ID is not correct</h1>
			<div class="small_padding"></div>
			<img src="{% static 'logo/bryte_logo_white.png' %}" width="100px">
		</div>
	<!--
	<div class="background_lki droid_serif">
		<div class="small_padding"></div>
		<div class="row">
			<div class="small_padding"></div>
			<div class="text-center">
			<form method="POST" action="{% url 'landing_retrieve1' %}" class="form-inline">{% csrf_token %}
				<input type="text" name="retrieve_search" id="retrieve_search" class="form-control mm_height large_font helvetica" required placeholder="Enter your Unique ID" onchange="try{setCustomValidity('')}catch(e){}" style="width:300px">
					<button class="btn btn-white-lg" id="retrieve_search_button" type="submit">Submit</button>
					<button class="btn btn-white-lg" id="retrieve_search_button_invis" type="submit" hidden style="display:none">Submit</button>
			</form>
			</div>

			{% if msg %}
				<p class="text-center">{{ msg }}</p>
			{% endif %}

			<div class="container">

			<div class="small_padding"></div>
			<h2 class="bold text-center">Recruiters spend a lot of time looking at your Linkedin headshot! And, on average, they spend 6 seconds looking at your resume total!</h2>

			<div class="small_padding"></div>

			<p class="text-center bold">This is a Linkedin Profile. <span class="red">The red spots are where recruiters are looking a lot</span>.</p>

			<div class="center_flex">
				<img src="{% static 'img/heatmap.png' %}" class="img-responsive">
			</div>

			<div class="medium_padding"></div>
			<div class="row">
				<div class="col-xs-10 col-xs-offset-1">
				<p class="text-center">(Sources: http://lifehacker.com/how-recruiters-really-look-at-your-linkedin-profile-and-1580589303, http://mashable.com/2011/11/30/social-profile-eye-tracking/)</p>
				</div>
			</div>
			</div>
			<div class="small_padding"></div>
		</div>
	</div>
	-->
	{% endif %}
	

	<!-- headshot page -->
	{% if headshots %}



	<div class="background_lki">
	<!-- checkout -->
	<div class="red_bg white checkout_cart" hidden>
	<div class="container">
		<div class="small_padding"></div>
		<h2 class="landing_title_third bold white">My Cart</h2>
		<span class="small_font">(if you want to remove anything from your cart, refresh the page, click continue when asked, and your cart will be cleared )</span>
		<div class="small_padding"></div>
		<div class="small_padding top_border"></div>



		<ul class="checkout_detail" class="package_list">

		</ul>
		<div class="text-right large_padding">
			<p class="checkout_original_total large_font">Subtotal: $<span class="checkout_original_total_amount"></span></p>
			<p class="yellow checkout_discount large_font">Discount: $<span class="checkout_discount_amount"></span></p>

			<div class="small_padding top_border"></div>
			<p class="bold big_font">Order Total: $<span class="checkout_total_amount"></span></p>
			<a href=""><button class="btn btn-blue checkout_button">Checkout</button></a>
		</div>
		<div class="medium_padding"></div>
	</div>
	</div>


		<div class="lki_container">
			<div class="medium_padding"></div>
			
			<div class="row">
				<div class="col-md-7 mod_container">


					<p class="helvetica small_font"><span class="bold red xlarge_font">Professional LinkedIn Headshot</span> â€“ actual size it will appear on Linkedin!</p>
					<!-- magnify -->

					<div class="background_white lki_box">
						<div class="full_height center_flex" id="{{ edited_fav.pk }}_thumbnail">
							<a class="magnifier-thumb-wrapper"><img id='thumb1' src="{{ edited_fav.wt_url }}" height="200"></a>
						</div>

						<div class="small_padding_left"></div>
						<div class="lki_content">
							<h3 class="bold xlarge_font">{{ booking.name }}</h3>
							<p class="">Sample LinkedIn profile</p>
							<div class="lki_line"></div>

							<div class="sm_padding"></div>
							<div class="inline">
								<p class="grey xsmall_font">Previous</p>
								<div class="small_padding_left"></div>
								<div class="lki_line_sm"></div>
							</div>
							<div class="xxsmall_padding"></div>
							<div class="inline">
								<p class="grey xsmall_font">Education</p>
								<div class="small_padding_left"></div>
								<div class="lki_line_sm"></div>
							</div>

							<div class="lki_offset"></div>

							<button class="btn-lki bold cursor_pointer">Connect</button>
						</div>
					</div>


					<div class="medium_padding"></div>
					
					<p class="helvetica small_font"><span class="bold xlarge_font">Standard LinkedIn Headshot</span> - actual size it will appear on Linkedin!</p>
					<div class="background_white lki_box">
						<div class="full_height center_flex" id="{{ raw_fav.pk }}_thumbnail">
							<a class="magnifier-thumb-wrapper"><img id='thumb2' src="{{ raw_fav.wt_url }}" height="200" ></a>
						</div>

						<div class="small_padding_left"></div>
						<div class="lki_content">
							<h3 class="bold xlarge_font">{{ booking.name }}</h3>
							<p class="">Sample LinkedIn profile</p>
							<div class="lki_line"></div>

							<div class="sm_padding"></div>
							<div class="inline">
								<p class="grey xsmall_font">Previous</p>
								<div class="small_padding_left"></div>
								<div class="lki_line_sm"></div>
							</div>
							<div class="xxsmall_padding"></div>
							<div class="inline">
								<p class="grey xsmall_font">Education</p>
								<div class="small_padding_left"></div>
								<div class="lki_line_sm"></div>
							</div>

							<div class="lki_offset"></div>

							<button class="btn-lki bold cursor_pointer">Connect</button>
						</div>
					</div>

					<div class="xsmall_padding"></div>
				</div>

				<div class="col-md-5 droid_serif">
					<!-- magnify place -->
					<div class="magnifier-preview" id="preview1" style="width:400px; height: 400px; position: absolute"></div>

					<div class="mod_container">
					<h3 class="bold zero_margin">Professional LinkedIn Headshot</h3>
					<div class="small_padding"></div>

					<div class="row">
						<div class="col-xs-8"><p class="small_font zero_margin">Studio and freelancers:</p></div>
						<div class="col-xs-4"><p class="small_font zero_margin"><del>$100</del></p></div>
					</div>
					<div class="row">
						<div class="col-xs-8"><p class="small_font zero_margin bold">Bryte Price:</p></div>
						<div class="col-xs-4"><p class="small_font zero_margin"><del>$19.99</del></p></div>
					</div>
					<div class="row">
						<div class="col-xs-8"><p class="bold landing_text_main zero_margin"><span class="red">Bryte Special Offer:</span></p></div>
						<div class="col-xs-4"><p class="red bold landing_text_main zero_margin">$9.99</p></div>
					</div>
					<div class="row">
						<div class="col-xs-8"><p class="small_font zero_margin">You save:<p></div>
						<div class="col-xs-4 small_font zero_margin red">$90.01 (90%)</div>
					</div>
					<p class="xsmall_font dark_grey">Bryte <span class="bold">Special Offer</span> only available for <span class="bold">two weeks</span> after the shoot</p>

					<div class="xsmall_padding"></div>
					<ul class="sm_font headshot_feature_b_list">
						<div class="text_border">
						<li class="bold italic red">Give the recruiter at your dream job a reason to look at your profile</li>
						<ul class="sm_font headshot_feature_list bold">
							<li>Recruiters look at hundreds of Linkedin profiles</li>
							<li><span class="red">Recruiters spend a lot of time looking at your Linkedin headshot!</span> And, on average, they spend 6 seconds looking at your resume total!</li>
						</ul>	
						</div>
						<div class="xsmall_padding"></div>
						<div class="xsmall_padding"></div>
						<li class="bold italic">Clear and bright lighting</li>
						<ul class="sm_font headshot_feature_list">
							<li>Brings out your features in a natural way</li>
							<li>Backdrop is touched up to be more well-lit and smooth to help you stand out</li>
						</ul>
						<li class="bold italic">Cropping to overcome the small LinkedIn thumbnail</li>
						<ul class="sm_font headshot_feature_list">
							<li>Makes your face clearly visible in the small LinkedIn thumbnail</li>
							<li>Personalized cropping for your headshot</li>
						</ul>	
						<li class="bold italic">Extra shine with touchup on every detail</li>
						<ul class="sm_font headshot_feature_list">
							<li>Acne and stray hair removal</li>
							<li>Glare removal on glasses</li>
						</ul>
						<li class="bold italic">High Resolution</li>
						<ul class="sm_font headshot_feature_list">
							<li>High level of detail in all areas of image</li>
							<li>1000 x 1000 pixels</li>
						</ul>
					</ul>


					<div class="small_padding"></div>
					<h3 class="bold small_padding">Standard LinkedIn Headshot</h3>
					<div class="small_padding"></div>

					<div class="row">
						<div class="col-xs-2"><p class="bold zero_margin"><span class="">Price:</span></p></div>
						<div class="col-xs-10"><p class="bold zero_margin">FREE</p></div>
					</div>

					<div class="xsmall_padding"></div>
					<ul class="sm_font headshot_feature_b_list">
						<li class="bold italic">Standard Resolution</li>
						<ul class="sm_font headshot_feature_list headshot_feature_list_black_bullet">
							<li>Standard level of detail in all areas of image</li>
							<li>500 x 500 pixels</li>
						</ul>
					</ul>

					<div class="small_padding"></div>
					<div class="small_padding"></div>
					<p>Choose your LinkedIn headshot:</p>
					<div class="row">
						<div class="col-xs-9">
						<select class="form-control mm_height l_font red_bg white" style="width:100%!important" id="fav_select">
							<option value="0" name="fh" data-description="Standard LinkedIn Headshot">Get LinkedIn Standard now</option>
							<option selected value="9.99" name="pu" data-description="Professional LinkedIn Headshot">Get LinkedIn Professional now</option>
						</select> 
						</div>
						<div class="col-xs-3">
						<button class="btn btn-checkout-white" id="fav_add" name="add">Add</button>
						</div>
					</div>
					<div class="small_padding"></div>
					<p class="zero_padding zero_margin"><span class="bold">Special offer</span> available until <span class="blue underline">August 7th</span></p>
					<p class="dark_grey xsmall_font italic">Watermark removed on all the headshots! Use your headshots however you'd like!</p>

				</div>
			</div>
		</div>
	</div>

		<div class="large_padding"></div>


	</div>
	<div class="background_pink">
		<div class="small_padding"></div>
		<h2 class="bold text-center droid_serif zero_margin">Turn the rest of your photos from the shoot into headshots or portraits!</h2>
		<div class="small_padding"></div>
	</div>
	<div class="red_bg">
		<div class="small_padding"></div>
		<h2 class="text-center droid_serif zero_margin white sm_font">Buy 2 headshot or portrait, <span class="yellow">get your third one for free!</span> (Discount will be automatically reflected at checkout)</h2>
		<div class="small_padding"></div>
	</div>

	<div class="">



		<div class="mod_container">
			
	
			<div class="small_padding"></div>
			<div class="medium_padding"></div>

			<div class="row">
				<div class="col-md-3 mod_container">
					<div class="text-center">
						<h3 class="bold droid_serif">Before</h3>
						<div class="small_padding"></div>
						<img src="{{ raw_top.wt_url }}" class="headshot_border" width="250">
						<p class="text-center droid_serif xsmall_padding">{{ raw_top.name }}</p>
						<div class="small_padding"></div>
					</div>
				</div>
				<div class="col-md-5 mod_container">

					<div class="center_flex">
					<h3 class="bold droid_serif">Extra Professional Headshot</h3>
					<div class="small_padding"></div>
					<a class="magnifier-thumb-wrapper"><img id="thumb3" src="{{ edited_fav.wt_url }}" height="200" class="headshot_border"></a>
					<p class="text-center droid_serif xsmall_padding small_font">(We used your professional<br>LinkedIn headshot above as an example)</p>
					</div>

					<div class="medium_padding"></div>

					<div class="center_flex">
						<h3 class="bold droid_serif">Premium Portrait</h3>
						<div class="small_padding"></div>
						<a class="magnifier-thumb-wrapper"><img id="thumb4" src="{{ edited_portrait.wo_url }}" width='400' class="headshot_border"></a>
					</div>

					<div class="xsmall_padding"></div>
				</div>
				<div class="col-md-4 droid_serif">
				<!-- magnify place -->
					<div class="magnifier-preview" id="preview2" style="width:350px; height:350px; position: absolute;"></div>

					<div class="mod_container">
					<h2 class="bold medium_padding">Extra Professional Headshot</h2>
					<div class="small_padding"></div>


					<div class="row">
						<div class="col-xs-8"><p class="small_font zero_margin">Studio and freelancers:</p></div>
						<div class="col-xs-4"><p class="small_font zero_margin">$100+</p></div>
					</div>
					<div class="row">
						<div class="col-xs-8"><p class="bold landing_text_main zero_margin"><span class="red">Bryte Price:</span></p></div>
						<div class="col-xs-4"><p class="red bold landing_text_main zero_margin">$19.99</p></div>
					</div>
					<div class="row">
						<div class="col-xs-8"><p class="small_font zero_margin">You save:<p></div>
						<div class="col-xs-4 small_font zero_margin red">$80.01 (80%)</div>
					</div>
					<p class="xsmall_font dark_grey">Photos <span class="bold">only available</span> in our database for <span class="bold">two weeks</span> after the shoot</p>



					<ul class="sm_font headshot_feature_b_list">
						<li class="bold italic">Clear and bright lighting</li>
						<ul class="sm_font headshot_feature_list">
							<li>Brings out your features in a natural way</li>
							<li>Backdrop is touched up to be more well-lit and smooth to help you stand out</li>
							<li>Uniquely adjusted lighting on each Premium Headshot we touch up</li>
						</ul>
						<li class="bold italic">Cropping to highlight you</li>
						<ul class="sm_font headshot_feature_list">
							<li>Emphasizes the clarity of your headshot</li>
							<li>Personalized cropping for all of our headshots</li>
						</ul>	
						<li class="bold italic">Touchup on every detail</li>
						<ul class="sm_font headshot_feature_list">
							<li>Acne touchup</li>
							<li>Stray hair removal</li>
							<li>Glare removal on glasses</li>
						</ul>
						<li class="bold italic">High Resolution</li>
						<ul class="sm_font headshot_feature_list">
							<li>High level of detail in all areas of image</li>
							<li>1000 x 1000 pixels</li>
						</ul>
					</ul>
					
					<div class="magnifier-preview" id="preview3" style="width:350px; height:437.5px; position: absolute;"></div>

					<div class="small_padding"></div>
					<h2 class="bold medium_padding">Premium Portrait</h2>
					<div class="small_padding"></div>


					<div class="row">
						<div class="col-xs-8"><p class="small_font zero_margin">Studio and freelancers:</p></div>
						<div class="col-xs-4"><p class="small_font zero_margin">$200+</p></div>
					</div>
					<div class="row">
						<div class="col-xs-8"><p class="bold landing_text_main zero_margin"><span class="red">Bryte Price:</span></p></div>
						<div class="col-xs-4"><p class="red bold landing_text_main zero_margin">$29.99</p></div>
					</div>
					<div class="row">
						<div class="col-xs-8"><p class="small_font zero_margin">You save:<p></div>
						<div class="col-xs-4 small_font zero_margin red">$170.01 (85%)</div>
					</div>
					<p class="xsmall_font dark_grey">Photos <span class="bold">only available</span> in our database for <span class="bold">two weeks</span> after the shoot</p>


					<ul class="sm_font headshot_feature_b_list">
						<li class="bold italic">Clear and bright lighting</li>
						<ul class="sm_font headshot_feature_list">
							<li>Brings out your features in a natural way</li>
							<li>Backdrop is touched up to be more well-lit and smooth to help you stand out</li>
							<li>Uniquely adjusted lighting on each Premium Portrait we touch up</li>
						</ul>
						<li class="bold italic red">Enhanced backdrop</li>
						<ul class="sm_font headshot_feature_list">
							<li>Extended on both sides of your body</li>
							<li>Improved and touched up color on the backdrop</li>
						</ul>	
						<li class="bold italic">Cropping to highlight you</li>
						<ul class="sm_font headshot_feature_list">
							<li>Emphasizes the clarity of your headshot</li>
							<li>Personalized cropping for all of our headshots</li>
						</ul>	
						<li class="bold italic">Touchup on every detail</li>
						<ul class="sm_font headshot_feature_list">
							<li>Acne touchup</li>
							<li>Stray hair removal</li>
							<li>Glare removal on glasses</li>
						</ul>
						<li class="bold italic">High Resolution</li>
						<ul class="sm_font headshot_feature_list">
							<li>High level of detail in all areas of image</li>
							<li>2000 x 2500 pixels</li>
						</ul>
					</ul>



					<div class="small_padding"></div>
					<select class="form-control sm_height l_font" style="width:100%!important" id="top_select">
						<option value="19.99" name="ph" data-description="Extra Professional Headshot" selected>Extra Professional Headshot</option>
						<option value="29.99" name="pp" data-description="Premium Portrait">Premium Portrait</option>
					</select> 
					<div class="small_padding"></div>
					<button class="btn btn-checkout" id="top_add_button" name="add">Add to cart</button>

					<div class="small_padding"></div>
					<p class="zero_padding zero_margin"><span class="bold">Photos</span> available until <span class="blue underline">August 7th</span></p>
					<p class="dark_grey xsmall_font italic">Watermark removed on all the headshots! Use your headshots however you'd like!</p>
				</div>
				</div>
			</div>


			<div class="medium_padding"></div>
			<div class="medium_padding red_top_border"></div>

			<div class="row">
			{% for extra in extras %}
				<div class="col-md-4 col-sm-6 mod_container droid_serif">
					<div>
						<img src="{{ extra.wt_url }}" class="img-responsive headshot_border" id="{{ extra.pk }}_thumbnail">
					</div>
					<p class="text-center xsmall_padding">{{ extra.name }}</p>
					<div class="xsmall_padding"></div>
					<select class="form-control sm_height l_font" style="width:100%!important" id="{{ extra.pk }}_select">
						<option selected value="19.99" name="ph" data-description="Extra Professional Headshot">Extra Professional Headshot - $19.99</option>
						<option value="29.99" name="pp" data-description="Premium Portrait">Premium Portrait - $29.99</option>
					</select> 			
					<div class="xsmall_padding"></div>
					<button class="btn btn-checkout" id="{{ extra.pk }}_add" name="add">Add to cart</button>
					<div class="xsmall_padding"></div>
					<p class="small_font dark_grey">Your headshot will be delivered via email within 48 hours</p>
					<div class="medium_padding"></div>
				</div>				
			{% endfor %}
			</div>

			<div class="large_padding"></div>
		</div>

	</div>
	<!-- checkout -->
	<div class="red_bg white checkout_cart">
	<div class="container">
		<div class="small_padding"></div>
		<h2 class="landing_title_third bold white">My Cart</h2>
		<span class="small_font">(if you want to remove anything from your cart, refresh the page, click continue when asked, and your cart will be cleared )</span>
		<div class="small_padding"></div>
		<div class="small_padding top_border"></div>



		<ul class="checkout_detail" class="package_list">

		</ul>
		<div class="text-right large_padding">
			<p class="checkout_original_total large_font">Subtotal: $<span class="checkout_original_total_amount"></span></p>
			<p class="yellow checkout_discount large_font">Discount: $<span class="checkout_discount_amount"></span></p>

			<div class="small_padding top_border"></div>
			<p class="bold big_font">Order Total: $<span class="checkout_total_amount"></span></p>
			<a href=""><button class="btn btn-blue checkout_button">Checkout</button></a>
		</div>
		<div class="medium_padding"></div>
	</div>
	</div>
	{% endif %}
	<!-- modal -->
	<a id="modal_link" href="#animatedModal" hidden></a>
	<div id="animatedModal">
	  <!--THIS IS IMPORTANT! to close the modal, the class name has to match the name given on the ID  class="close-animatedModal" -->
	  <div class="close-animatedModal text-center" id="modal_close_link"> 
	      <div class="medium_padding"></div>
	      <a href="" class="modal_close white xbig_font"><i class="fa fa-times-circle-o"></i></a>
	  </div>

	  <div class="white text-center medium_padding large_font">      
	  <p id="modal_content"></p>
	  </div>
	</div>

	<!-- loader -->
	<div id="loader-wrapper" hidden>
	  <div id="loader" class="text-center"><img src="{% static 'logo/loading.svg' %}" width="140px"></div>
	</div>

{% endblock %}

{% block script %}
  <script src="https://checkout.stripe.com/checkout.js"></script>
  <script src="{% static 'js/animatedModal.min.js' %}"></script>
  <script src="{% static 'js/Event.js' %}"></script>
  <script src="{% static 'js/Magnifier.js' %}"></script>
	<script type="text/javascript">
		// cookies
	  function getCookie(name) {
	    var cookieValue = null;
	    if (document.cookie && document.cookie != '') {
	        var cookies = document.cookie.split(';');
	        for (var i = 0; i < cookies.length; i++) {
	            var cookie = jQuery.trim(cookies[i]);
	            // Does this cookie string begin with the name we want?
	            if (cookie.substring(0, name.length + 1) == (name + '=')) {
	                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
	                break;
	            }
	        }
	    }
	    return cookieValue;
		}
		var csrftoken = getCookie('csrftoken');
		// magnifier
			var evt = new Event(),
	    m = new Magnifier(evt);
			m.attach({
			    thumb: '#thumb1',
			    large: '{{ edited_fav.wo_url }}',
			    largeWrapper: 'preview1',
			    zoom: 1.8
			});
			m.attach({
			    thumb: '#thumb2',
			    large: '{{ raw_fav.wt_url }}',
			    largeWrapper: 'preview1',
			    zoom: 2.5
			});
			m.attach({
			    thumb: '#thumb3',
			    large: '{{ edited_fav.wo_url }}',
			    largeWrapper: 'preview2',
			    zoom: 2.5
			});
			m.attach({
			    thumb: '#thumb4',
			    large: '{{ edited_portrait.wo_url }}',
			    largeWrapper: 'preview3',
			    zoom: 2.5
			});
	</script>
{% endblock %}

{% block jquery %}
	var total = 0;
	var purchases = []


	// enter id
	$('#retrieve_search_button').on('click', function(e){
		e.preventDefault();
		console.log('asd');
		$('#loader-wrapper').show();
		setTimeout(function(){
			$('#loader-wrapper').hide();
			$('#retrieve_search_button_invis').trigger('click');
		}, 6000);
	});

  // modal 
  $("#modal_link").animatedModal({
    animatedIn: 'zoomInUp',
    animatedOut: 'bounceOutDown',
    color: '#c94848'
  });

  $('#modal_close_link').click(function(){
    location.reload();
  }).ajaxStart(function () {
    $("#loader-wrapper").show();
  }).ajaxStop(function () {
    $("#loader-wrapper").hide();
  });

	$('.checkout_cart').hide();
	$('.checkout_discount').hide();
	$('.checkout_original_total').hide();

	// show form
	$("button[name=add]").click(function(e){
		e.preventDefault();
		// show loader
		$('#loader-wrapper').show();
		setTimeout(function(){
			$('#loader-wrapper').hide();
		}, 300);

		var $select;
		var id = e.target.id;
		var thumbnail='';
		var pk;

		if(id=='fav_add'){
			$select = $('#fav_select');
			if($select.find(':selected').attr('name')=='fh'){
				thumbnail='{{ raw_fav.wt_url }}';
				pk='{{ raw_fav.pk }}';
			}
			if($select.find(':selected').attr('name')=='pu'){
				thumbnail='{{ edited_fav.wt_url }}';
				pk='{{ edited_fav.pk }}';
			}
		} 
		else if(id=='top_add_button'){
			$select = $('#top_select');
			if($select.find(':selected').attr('name')=='ph'){
				thumbnail='{{ edited_top.wt_url }}';
				pk='{{ edited_top.pk }}';
			}
			if($select.find(':selected').attr('name')=='pp'){
				thumbnail='{{ edited_portrait.wt_url }}';
				pk='{{ edited_portrait.pk }}';
			}		
		}
		else{
			pk = id.split('_')[0];
			select_id = '#'+pk+'_select';
			$select = $(select_id);
			thumbnail_id='#'+pk+'_thumbnail';
			thumbnail = $(thumbnail_id).attr('src');
		}


    option_val = $select.find(':selected').val();
    option_text = $select.find(':selected').data('description');
    option_name = $select.find(':selected').attr('name');


    // console.log(thumbnail);

    var purchase = {
    	'img_id': pk,
    	'option': option_name,
    	'value': option_val,
    };
    purchases.push(purchase);

    // console.log(purchases);
    // update the total

    total = total + parseFloat(option_val);
    if($('#checkout_total').is(":hidden")){
    	$('#checkout_total').fadeIn(200)
    }

    // detect discount
   	count = 0;
   	discount_amount = 0;
   	for(var i=0; i<purchases.length; i++){
   		if(purchases[i].option == 'ph' | purchases[i].option == 'pp'){
   			count += 1;
   		}
   	}
   	discount_count = Math.floor(count/3);
   	discount_amount = discount_count * 30;
   	if(discount_count){
   		$('.checkout_discount').show();
   		$('.checkout_original_total').show();
   		$('.checkout_original_total_amount').html(total.toFixed(2));
   		$('.checkout_discount_amount').html(discount_amount);
   	}
   	console.log(discount_count);


    $('.checkout_total_amount').html((total - discount_amount).toFixed(2));

    checkout_html = '<li class="row"><div class="col-xs-6"><img src="' + thumbnail + '" style="height:120px!important" class="video_desc_border"><div class="xsmall_padding small_font"><p>(When we email you your headshot, it will have the watermark removed and will include any touchup processes that you have purchased)</p></div></div><div class="col-xs-6 text-center"><p>' + option_text + '<br>$' + option_val + '</p></div></li>';

		$('.checkout_detail').append(checkout_html);
		$('.checkout_cart').fadeIn(200);
	})
	// all ajax

  var csrftoken = getCookie('csrftoken');

  function csrfSafeMethod(method) {
  // these HTTP methods do not require CSRF protection
  return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
  }


  $.ajaxSetup({
      beforeSend: function(xhr, settings) {
          if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
              xhr.setRequestHeader("X-CSRFToken", csrftoken);
          }
      }
  });
  var handler = StripeCheckout.configure({
  	
    key: '{{ publish_key }}',
    locale: 'auto',
    token: function(token) {
      // You can access the token ID with `token.id`.
      // Get the token ID to your server-side code for use.
      $.ajax({
	  		url: '{% url "landing_retrieve1" %}',
	  		type: 'POST',
	  		data: {
	  			purchases: JSON.stringify(purchases),
	  			token: token.id,
	  			subtotal: total.toFixed(2),
	  			total: (total - discount_amount).toFixed(2),
	  		},

	      success: function(data){
          $("#modal_content").html(data['msg']);
          $("#modal_link").trigger('click');
	      },

	      failure: function(data){
          $("#modal_content").html('Something wrong happened, please try again. Thanks!')
          $("#modal_link").trigger('click');
	      }
	  	})
    }
  });

  $('.checkout_button').on('click', function(e) {
    // Open Checkout with further options:
    if(total==0){
			// show loader
			$('#loader-wrapper').show();   
    	$.ajax({
	  		url: '{% url "landing_retrieve1" %}',
	  		type: 'POST',
	  		data: {
	  			is_download: true,
	  			pk: '{{ raw_fav.pk }}',
	  		},
	      success: function(data){
	        $("#modal_content").html(data['msg']);
	        $("#modal_link").trigger('click');
	      },
	      failure: function(data){
	        $("#modal_content").html('Something wrong happened, please try again. Thanks!')
	        $("#modal_link").trigger('click');
	      }
    	})
    }else{
    	$('#loader-wrapper').show();
    	handler.open({
	      name: 'Bryte Headshot Upgrade',
	      description: 'Bryte Headshot Upgrade',
	      amount: (total - discount_amount).toFixed(2) * 100,
    	});
    }
    e.preventDefault();
  });

  // Close Checkout on page navigation:
  $(window).on('popstate', function() {
    handler.close();
    $('#loader-wrapper').hide();
  });

  $(".close").click(function(){
  	$('#loader-wrapper').hide();
  })

{% endblock %}