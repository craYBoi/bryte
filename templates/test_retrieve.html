{% extends "base.html" %}
{% load staticfiles %}

{% block stylesheet %}
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/animate.css/3.2.0/animate.min.css">
  <link rel="stylesheet" type="text/css" href="{% static 'css/justifiedGallery.min.css' %}">
  <link rel="stylesheet" type="text/css" href="{% static 'css/lightgallery.css' %}">
{% endblock %}

{% block content %}
	<div class="red_bg">
		{% if not deliverable %}
		<div class="medium_padding"></div>
		<h1 class="text-center white landing_title_sec bold">Enter your ID to view and download your headshots!</h1>

		<div class="row">
			<div class="small_padding"></div>
			<div class="text-center">
			<form method="POST" action="{% url 'landing_retrieve1' %}" class="form-inline">{% csrf_token %}
				<input type="text" name="retrieve_search" id="retrieve_search" class="form-control" required placeholder="your 6-digit photo retrieval ID" onchange="try{setCustomValidity('')}catch(e){}" style="width:250px">
					<button class="btn btn-white" id="retrieve_search_button" type="submit">Submit</button>
			</form>
			</div>
			<div class="small_padding"></div>

			{% if msg %}
				<p class="white text-center">{{ msg }}</p>
			{% endif %}
			<div class="container" id='landing_sales_pricing'>
				<div class="small_padding"></div>
				<p class="white text-center">The industry charges $100 for touched up headshots. <br>Bryte premium touchup is $2.99. Check it out below.</p>
			</div>

			<div class="container">
			<div class="medium_padding"></div>
			<div class="row">
				<div class="col-sm-4">
					<img src="{% static 'img/affordable/premium 4.jpg' %}" class="img-responsive">
					<p class="text-center white xsmall_padding">Original</p>
				</div>
				<div class="col-sm-4">
					<img src="{% static 'img/affordable/premium 5.jpg' %}" class="img-responsive">
					<p class="text-center white xsmall_padding">Standard Touchup</p>
				</div>
				<div class="col-sm-4">
					<img src="{% static 'img/affordable/premium 6 text.jpg' %}" class="img-responsive">
					<p class="text-center white xsmall_padding">Premium Touchup</p>
				</div>
			</div>
			</div>


					
		</div>
		{% endif %}

		<div class="medium_padding"></div>
		<div class="container">
		{% if deliverable %}
			<div class="white" id="deliverables_title"></div>



			<h2 class="landing_title_third white bold">Here is your free LinkedIn headshot plus two special offers!</h2>
			<a href="#landing_sales_pricing"><button class="btn btn-white-lg large_font">Learn about Our Offerings</button></a>
			<div class="small_padding"></div>
			<div class="small_padding top_border"></div>


			<!-- total -->
			<div class="text-right" id="checkout_total" hidden>
				<p class="white"><span class="big_font bold">Total: $<span class="checkout_total_amount"></span></span> <br><a href="#checkout_detail" class="white">See my cart</a></p> 
				<button class="btn btn-blue checkout_button">Checkout</button>
				<div class="medium_padding"></div>
			</div>
			

			<div class="lightgallery row">
				<div class="col-sm-4">
					<div class="small_padding"></div>
					<h4 class="white text-center sm_font">Free Headshot with Standard Touchup Sized for Linkedin</h4>
					<div class="deliverables text-center">
						<img src="{{ deliverable.original_url }}" style="height: 200px!important" class="video_desc_border" />
					</div>
					
					<div class="small_padding"></div>
					<div class="text-center">
						<button class="btn btn-blue bold" style="width:100%!important" id="download_button" name='{{ deliverable.pk }}' data-url="{{ deliverable.original_url }}">Add to cart for FREE</button>
					</div>


					<!--

					<div id="download_loader" class="row">
						<div class="small_padding"></div>
						<div class="col-sm-6"><p class="white">preparing your headshot for downloading..</p></div>
						<div class="col-sm-6">
						<img src="{% static 'logo/loading.svg' %}" width="60px">
						</div>
						<div class="xsmall_padding"></div>
					</div>
					-->
				</div>

				<div class="col-sm-4">
					<div class="small_padding"></div>
					<h4 class="white text-center sm_font">Upgrade with Premium Touchup and keep your full size photo for <span class="bold">50% off</span></h4>
					<div class="deliverables text-center">
						<a href="{{ premium.original_url }}"><img src="{{ premium.thumbnail_url }}" style="height: 200px!important" class="video_desc_border" /></a>
					</div>
					<div class="small_padding"></div>
					<div class="text-center">
						<button class="btn btn-blue bold" style="width:100%!important" id="premium_button" name='{{ premium.pk }}' data-url="{{ premium.thumbnail_url }}">Add to cart for $4.99</button>
					</div>
					<p class="white text-center xsmall_padding large_font">Normally priced: <del class="large_font">$9.99</del></p>
				</div>

				<div class="col-sm-4">
					<div class="small_padding"></div>
					<h4 class="white text-center sm_font">Keep the full size photo with Standard Touchup for <span class="bold">50% off</span></h4>
					<div class="deliverables text-center">
						<a href="{{ fullsize.original_url }}"><img src="{{ fullsize.thumbnail_url }}" style="height: 200px!important" class="video_desc_border" /></a>
					</div>
					<div class="small_padding"></div>
					<div class="text-center">
						<button class="btn btn-blue bold" style="width:100%!important" id="fullsize_button" name='{{ fullsize.pk }}' data-url="{{ fullsize.thumbnail_url }}">Add to cart for $2.99</button>
					</div>
					<p class="white text-center xsmall_padding large_font">Normally priced: <del class="large_font">$6.99</del></p>
				</div>

			</div>
							<!-- Change dropdown to button
							<form class="" id="{{ headshot.pk }}_form">

								<div class="xsmall_padding"></div>
								<select class="form-control" id="{{ headshot.pk }}_select">
									<option value="2.99" class="premium_touchup_option" id="{{ headshot.pk }}_premium_touchup_option" name="pt">Original Headshot + Premium Touchup - $2.99</option>
									<option value="7.99" class="passport_option" id="{{ headshot.pk }}_passport_option" name='pp'>Passport Package - $7.99</option>
								</select>
								<input type="hidden" value="{{ headshot.thumbnail_url }}" id="{{ headshot.pk }}_thumbnail_url">
								<div class="xsmall_padding"></div>

								<div class="xsmall_padding"></div>

								<div class="row">
									<div class="col-xs-9">
										<input type="text" id="{{ headshot.pk }}_request" placeholder="Type Special Requests" class="form-control">				
										<input type="text" id="{{ headshot.pk }}_address" placeholder="Type your mailing address" class="form-control form_address" hidden>		
									</div>	
									<div class="col-xs-3">
										<button type="submit" class="btn btn-default" id="{{ headshot.pk }}_add" name="photo_add">Add</button>
									</div>	
								</div>
							</form>
							-->
				<div class="medium_padding"></div>

				<h2 class="landing_title_third white bold">Here are the rest of your headshots!</h2>
				<a href="#landing_sales_pricing"><button class="btn btn-white-lg large_font">Learn about Our Offerings</button></a>
				<div class="small_padding"></div>
				<div class="small_padding top_border"></div>

				<div class="lightgallery row">
					{% for headshot in extra %}
						<div class="col-sm-4 col-sm-offset-0 col-xs-10 col-xs-offset-1">
						<div class=" deliverables">		
							<a href="{{ headshot.original_url }}"><img src="{{ headshot.thumbnail_url }}" class="img-responsive video_desc_border" /></a>
						</div>
						<form class="" id="{{ headshot.pk }}_form">
							<div class="xsmall_padding"></div>
							<select class="form-control" id="{{ headshot.pk }}_select">
								<option selected value="4.99" name="oh">Full Sized headshot - $4.99</option>
								<option value="6.99" name="st" id="{{ headshot.pk }}_standard_touchup_option">Full Sized headshot with Standard Touchup - $6.99</option>
								<option value="9.99" id="{{ headshot.pk }}_premium_touchup_option" name="pt">Full sized headshot with Premium Touchup - $9.99</option>
								<option value="12.99" id="{{ headshot.pk }}_passport_option" name="pp">US Passport/Visa/IDs Package - $12.99</option>
							</select>
							<input type="hidden" value="{{ headshot.thumbnail_url }}" id="{{ headshot.pk }}_thumbnail_url">
							<div class="xsmall_padding"></div>
								<div class="row">
									<div class="col-xs-9">
										<input type="text" id="{{ headshot.pk }}_request" placeholder="Type Special Requests" required class="form-control form_request">				
										<input type="text" id="{{ headshot.pk }}_address" placeholder="Type your mailing address" class="form-control form_address" required hidden>		
									</div>	
									<div class="col-xs-3">
										<button type="submit" class="btn btn-default" id="{{ headshot.pk }}_add" name="photo_add">Add</button>
									</div>	
								</div>
								<p class="xsmall_padding white small_font" id="{{ headshot.pk }}_standard_text" hidden>After you checkout we will touch up this headshot and email you the touched up version within 48 hours</p>
								<p class="xsmall_padding white small_font" id="{{ headshot.pk }}_premium_text" hidden>After you checkout we will touch up this headshot and email you the touched up version within 48 hours</p>
								<p class="xsmall_padding white small_font" id="{{ headshot.pk }}_passport_text" hidden>Special Note for passport request</p>
						</form>
					<div class="medium_padding"></div>
					</div>
				{% endfor %}
			</div>		
		

		</div>
		<div class="small_padding"></div>
		<div class="text-center">
			<a href="#landing_sales_pricing"><button class="btn btn-white-lg large_font">Learn about Our Offerings</button></a>
		</div>
		<div class="small_padding"></div>
		<p class="white text-center">Have questions? Email us at <a href="mailto:hello@brytephoto.com" target="_top" class="pink">hello@brytephoto.com</a> or call us at (248)-417-5852</p>



		<div class="container" id="checkout_cart">
			<h2 class="landing_title_third white bold">My Cart</h2>
			<span class="small_font light white">(if you want to remove anything from your cart, refresh the page, click continue when asked, and your cart will be cleared )</span>
			<div class="small_padding"></div>
			<div class="small_padding top_border"></div>



			<ul id="checkout_detail" class="package_list">

			</ul>
			<div class="text-right">
				<p class="white bold big_font large_padding">Total: $<span class="checkout_total_amount"></span></p>
				<a href=""><button class="btn btn-blue checkout_button">Checkout</button></a>
			</div>
		</div>

		<div class="medium_padding"></div>



		<div class="medium_padding top_border"></div>

	<!-- Pricing -->
	<div class="container" id='landing_sales_pricing'>
		<h2 class="text-center landing_title bold white">Bryte Offerings</h2>
		<p class="xsmall_padding text-center white">Click on an offering to learn more about it</p>
		<div class="medium_padding"></div>
		<div class="row">
			<div class="small_padding"></div>
			<div class="row">
				<div class="col-xs-10 col-xs-offset-1 price_list_card pricing_list background_white">
					<div class="page-header small_margin zero_margin_bot">
						<h4 class="bold red landing_text_main text-center">Linkedin Headshot with Standard Touchup</h4>
					</div>
					<p class="bold red landing_title_third text-center small_padding">FREE</p>
					<ul>
						<li>Digital copy of a headshot with standard touchup, already sized for Linkedin, on us!</li>
						<li>500 x 500 pixels</li>
					</ul>
				</div>
			</div>
		</div>

		<div class="small_padding"></div>

		<div class="row sm_font">
			<div class="col-md-4">

				<div class="small_padding"></div>
				<div class="row">
				<a href="{% url 'landing_sales' %}#original_headshot">
					<div class="col-xs-10 col-xs-offset-1 price_list_card pricing_list background_white">
						<div class="page-header small_margin zero_margin_bot">
							<h4 class="bold red landing_text_main text-center">Full sized headshot</h4>
						</div>
						<p class="bold red landing_title_third text-center small_padding">$4.99</p>
						<ul>
							<li>Perfect for people who want to touchup their headshots themselves!</li>
							<li>Receive a full sized digital copy (3000+ x 3000+ pixels) of a headshot you took at the shoot</li>
							<li>Full sized digital copy</li>
							<li>Headshot will be emailed to you within 24 hours</li>
							<li>The headshot you buy will be exactly how it looks in the thumbnail, but will NOT include the Bryte logo on it</li>
						</ul>
					</div>
				</a>
				</div>
				<div class="small_padding"></div>
			</div>

			<div class="col-md-4">
				<div class="small_padding"></div>
				<div class="row">
				<a href="{% url 'landing_sales' %}#standard_touchup">
					<div class="col-xs-10 col-xs-offset-1 price_list_card pricing_list background_white">
						<div class="page-header small_margin zero_margin_bot">
							<h4 class="bold red landing_text_main text-center">Full sized headshot with Standard Touchup</h4>
						</div>
						<p class="bold red landing_title_third text-center small_padding">$6.99</p>
						<ul>
							<li>Touched up by a Bryte Photoshop Magician</li>
							<li>Improved lighting on face, body and background</li>
							<li>Backdrop you are in front will be extended horizontally</li>
							<li>Glare will be removed on glasses</li>
							<li>Headshot will be emailed to you within 48 hours</li>
						</ul>
					</div>
				</a>
				</div>
			</div>

			<div class="col-md-4">
				<div class="small_padding"></div>
				<div class="row">
				<a href="{% url 'landing_sales' %}#premium_touchup">
					<div class="col-xs-10 col-xs-offset-1 price_list_card pricing_list background_white">
						<div class="page-header small_margin zero_margin_bot">
							<h4 class="bold red landing_text_main text-center">Full sized headshot with Premium Touchup</h4>
						</div>
						<p class="bold red landing_title_third text-center small_padding">$9.99</p>
						<ul>
							<li>Everything in "Headshot with Standard Touchup"</li>
							<li>Acne/Mole removal</li>
							<li>We will take custom requests (within reason) at the time of purchase</li>
							<li>Stray hair removal</li>
							<li>Natural skin smoothening</li>
							<li>Natural teeth whitening</li>
							<li>Natural Eye enhancement</li>
							<li>Headshot will be emailed to you within 48 hours</li>
						</ul>
					</div>
				</a>
				</div>
			</div>
		</div>

		<div class="small_padding"></div>

		<div class="row">
			<div class="small_padding"></div>
			<div class="row">
			<a href="{% url 'landing_sales' %}#passport_package">
				<div class="col-xs-10 col-xs-offset-1 price_list_card pricing_list background_white">
					<div class="page-header small_margin zero_margin_bot">
						<h4 class="bold red landing_text_main text-center">US Passport/VISA/IDs Package</h4>
					</div>
					<p class="bold red landing_title_third text-center small_padding">$12.99</p>
					<ul>
						<li>Your headshot will undergo our Standard Touchup process, AND will be touched up and resized according to requirements specified by the US Department of State</li>
						<li>6 2x2 glossy prints of the touched up headshot delivered to an address in the US</li>
						<li>You’ll also be emailed 2 digital headshots:  the headshot with Standard touchup at it’s original size AND the headshot with Standard touchup at it’s 2x2 resized version</li>
						<li>Touched up photos will be emailed to you within 48 hours of purchase.  Prints will be delivered within 1 week of purchase</li>
						<li class="bold">Your headshot must be in front of a white backdrop, where you are not showing teeth, and your body is turned directly towards the camera</li>
					</ul>
				</div>
			</a>
			</div>
		</div>
	</div>

	<div class="container">

			<!-- table -->
			<div class="large_padding"></div>
			<h3 class="white text-center landing_title_third">Prices for a single headshot in the industry</h3>
			<div class="small_padding"></div>
			<div class="background_white">
			<table class="table">
			  <thead>
			    <tr>
			      <th></th>
			      <th>Price</th>
			      <th>On Location</th>
			      <th>Touchup</th>
			    </tr>
			  </thead>
			  <tbody>
			    <tr class="landing_text_main bold red danger">
			      <th scope="row">Bryte</th>
			      <td>< $13</td>
			      <td>Yes</td>
			      <td>Yes</td>
			    </tr>
			    <tr class="landing_text">
			      <th scope="row">JCPenney</th>
			      <td>$49.99</td>
			      <td>No</td>
			      <td>No</td>
			    </tr>
			    <tr class="landing_text">
			      <th scope="row">Photography Studios</th>
			      <td>$50+</td>
			      <td>Extra $</td>
			      <td>No</td>
			    </tr>
			    <tr class="landing_text">
			      <th scope="row">Freelancer</th>
			      <td>$100+</td>
			      <td>Extra $</td>
			      <td>Extra $</td>
			    </tr>
			  </tbody>
			</table>
			</div>



			<div class="large_padding"></div>			
			<h3 class="white text-center landing_title_third bold">Testimonials</h3>
			<div class="medium_padding"></div>
			<div class="row">
				<div class="col-sm-3">
					<p class="white landing_text">"I've been waiting for this forever"<br><br> – Mikaela G., Junior</p>
				</div>
				<div class="col-sm-3">
					<p class="white landing_text">"It was really quick and professional. I felt really good about the photos."<br><br> – Matt C., Sophomore</p>
				</div>
				<div class="col-sm-3">
					<p class="white landing_text">"Affordable, being a college student and I’m broke. But still very high quality."<br><br> – Travis F., Freshman</p>
				</div>
				<div class="col-sm-3">
					<p class="white landing_text">"Simple and easy, and the pictures look great"<br><br> – Sam W., Freshman</p>
				</div>
			</div>
			<div class="large_padding"></div>
			<p class="white text-center">Have questions? Email us at <a href="mailto:hello@brytephoto.com" target="_top" class="pink">hello@brytephoto.com</a> or call us at (248)-417-5852</p>
			<div class="medium_padding"></div>
		</div>
		{% endif %}

	</div>
	</div>




	<!-- modal -->
	<a id="modal_link" href="#animatedModal" hidden></a>
	<div id="animatedModal">
	  <!--THIS IS IMPORTANT! to close the modal, the class name has to match the name given on the ID  class="close-animatedModal" -->
	  <div class="close-animatedModal text-center" id="modal_close_link"> 
	      <div class="medium_padding"></div>
	      <a href="" class="modal_close white xbig_font"><i class="fa fa-times-circle-o"></i></a>
	  </div>

	  <div class="white text-center medium_padding large_font">      
	  <p id="modal_content"></p>
	  </div>
	</div>

	<!-- loader -->
	<div id="loader-wrapper" hidden>
	  <div id="loader" class="text-center"><img src="{% static 'logo/loading.svg' %}" width="140px"></div>
	</div>
{% endblock %}

{% block script %}
  <script src="{% static 'js/lightgallery.js' %}"></script>
  <script src="{% static 'js/lg-thumbnail.js' %}"></script>
  <script src="{% static 'js/lg-fullscreen.js' %}"></script>
  <script src="https://checkout.stripe.com/checkout.js"></script>
  <script src="{% static 'js/animatedModal.min.js' %}"></script>
	<script type="text/javascript">
	  function getCookie(name) {
	    var cookieValue = null;
	    if (document.cookie && document.cookie != '') {
	        var cookies = document.cookie.split(';');
	        for (var i = 0; i < cookies.length; i++) {
	            var cookie = jQuery.trim(cookies[i]);
	            // Does this cookie string begin with the name we want?
	            if (cookie.substring(0, name.length + 1) == (name + '=')) {
	                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
	                break;
	            }
	        }
	    }
	    return cookieValue;
		}
		var csrftoken = getCookie('csrftoken');
	</script>
{% endblock %}
{% block jquery %}
 	
	var total = 0;

	var purchases = []


	// download
	$('#download_loader').hide();
	$('#download_button').click(function(e){
		// show loader
		$('#loader-wrapper').show();
		setTimeout(function(){
			$('#loader-wrapper').hide();
		}, 300); 

		e.preventDefault();
		$('#checkout_total').fadeIn(200)
		$('.checkout_total_amount').html(total.toFixed(2));

		thumbnail_url = $('#download_button').attr('data-url')
    checkout_html = '<li class="row"><div class="col-xs-6"><img src="' + thumbnail_url + '" style="height:120px!important" class="video_desc_border"></div><div class="col-xs-6 white text-center"><p>Full Size with Standard touchup - FREE</p></div></li>';
    $('#checkout_detail').append(checkout_html);
    $('#checkout_cart').fadeIn(200);

		purchases.push({
    	'img_id': $('#download_button').attr('name'),
    	'option': 'oh',
    	'value': 0,
		})
	});


	// fullsize and premium
	$('#fullsize_button').click(function(e){
		// show loader
		$('#loader-wrapper').show();
		setTimeout(function(){
			$('#loader-wrapper').hide();
		}, 300);

		purchases.push({
    	'img_id': $('#fullsize_button').attr('name'),
    	'option': 'st',
    	'value': 2.99,
		})
		total = total + 2.99;
    if($('#checkout_total').is(":hidden")){
    	$('#checkout_total').fadeIn(200)
    }
    $('.checkout_total_amount').html(total.toFixed(2));

    thumbnail_url = $('#fullsize_button').attr('data-url')
    checkout_html = '<li class="row"><div class="col-xs-6"><img src="' + thumbnail_url + '" style="height:120px!important" class="video_desc_border"></div><div class="col-xs-6 white text-center"><p>Full Size with Standard touchup - <del>$6.99</del> $2.99</p></div></li>';

		$('#checkout_detail').append(checkout_html);
		$('#checkout_cart').fadeIn(200);
    e.preventDefault();
	});

	$('#premium_button').click(function(e){
		// show loader
		$('#loader-wrapper').show();
		setTimeout(function(){
			$('#loader-wrapper').hide();
		}, 300);
		purchases.push({
    	'img_id': $('#premium_button').attr('name'),
    	'option': 'pt',
    	'value': 4.99,
		})
		total = total + 4.99;
    if($('#checkout_total').is(":hidden")){
    	$('#checkout_total').fadeIn(200)
    }
    $('.checkout_total_amount').html(total.toFixed(2));

    thumbnail_url = $('#fullsize_button').attr('data-url')
    checkout_html = '<li class="row"><div class="col-xs-6"><img src="' + thumbnail_url + '" style="height:120px!important" class="video_desc_border"></div><div class="col-xs-6 white text-center"><p>Full Size with Premium touchup - <del>$9.99</del> $4.99</p></div></li>';

		$('#checkout_detail').append(checkout_html);
		$('#checkout_cart').fadeIn(200);
    e.preventDefault();
	});





	$(document).ready(function(event, xhr, settings) {
		var $gallery = $('.deliverables');
		$gallery.lightGallery({
			thumbnail: true,
		})
	});

  // modal 
  $("#modal_link").animatedModal({
    animatedIn: 'zoomInUp',
    animatedOut: 'bounceOutDown',
    color: '#c94848'
  });

  $('#modal_close_link').click(function(){
    location.reload();
  }).ajaxStart(function () {
    $("#loader-wrapper").show();
  }).ajaxStop(function () {
    $("#loader-wrapper").hide();
  });

	$('#checkout_total').hide();
	$('#checkout_cart').hide();
	$('.form_address').hide();
	$('.form_request').hide();

	// show form
	$('select').on('change', function(e){
		var select_id = e.target.id;
		var pk = select_id.split('_')[0];
		pt_id = '#' + pk + '_premium_touchup_option';
		pp_id = '#' + pk + '_passport_option';
		st_id = '#' + pk + '_standard_touchup_option';
		addr_id = '#' + pk + '_address';
		req_id = '#' + pk + '_request';
		standard_text = '#' + pk + '_standard_text';
		premium_text = '#' + pk + '_premium_text';
		passport_text = '#' + pk + '_passport_text';

		if($(st_id).is(':selected')){
			$(standard_text).fadeIn(200)
		}
		else{
			$(standard_text).fadeOut(200);
		}

		if($(pt_id).is(':selected')){
			$(req_id).fadeIn(200);
			$(premium_text).fadeIn(200);
		}
		else{
			$(req_id).fadeOut(200);
			$(req_id).val('');
			$(premium_text).fadeOut(200);
		}
		if($(pp_id).is(':selected')){
			$(addr_id).fadeIn(200);
			$(passport_text).fadeIn(200);
		}
		else{
			$(addr_id).fadeOut(200);
			$(addr_id).val('');
			$(passport_text).fadeOut(200);
		}
	})

	$("button[name=photo_add]").click(function(e){
		e.preventDefault();

		// show loader
		$('#loader-wrapper').show();
		setTimeout(function(){
			$('#loader-wrapper').hide();
		}, 300);

    var idClicked = e.target.id;
    var pk = idClicked.split('_')[0];
    thumbnail_id = '#' + pk + '_thumbnail_url';
    thumbnail_url = $(thumbnail_id).val();
    select_id = '#' + pk + '_select';
    option_val = $(select_id).find(':selected').val();
    option_text = $(select_id).find(':selected').text();
    option_name = $(select_id).find(':selected').attr('name');


    var purchase = {
    	'img_id': pk,
    	'option': option_name,
    	'value': option_val,
    };
    purchases.push(purchase);

    // update the total

    total = total + parseFloat(option_val);
    if($('#checkout_total').is(":hidden")){
    	$('#checkout_total').fadeIn(200)
    }
    $('.checkout_total_amount').html(total.toFixed(2));


    // get the addr and req
		addr_id = '#' + pk + '_address';
		req_id = '#' + pk + '_request';
		special_checkout_html = '';


    if($(addr_id).val()){
    	special_checkout_html = '<div class="col-xs-6 white text-center"><p>Mailing Address: ' + $(addr_id).val() + '</p></div>';
    	

    	// add to the data
    	purchase['address'] = $(addr_id).val();
    	$(addr_id).val('');
    }
    if($(req_id).val()){
    	special_checkout_html = '<div class="col-xs-6 white text-center"><p>Special Requests: ' + $(req_id).val() + '</p></div>';

  
    	// add to the data
    	purchase['request'] = $(req_id).val();
    	$(req_id).val('');
    }

    
    checkout_html = '<li class="row"><div class="col-xs-6"><img src="' + thumbnail_url + '" style="height:120px!important" class="video_desc_border"><div class="xsmall_padding small_font"><p class="white">(When we email you your headshot, it will have the watermark removed and will include any touchup processes that you have purchased)</p></div></div><div class="col-xs-6 white text-center"><p>' + option_text + '</p></div>'+ special_checkout_html +'</li>';

		$('#checkout_detail').append(checkout_html);
		$('#checkout_cart').fadeIn(200);
		//console.log(purchases);
	});




	// all ajax

  var csrftoken = getCookie('csrftoken');

  function csrfSafeMethod(method) {
  // these HTTP methods do not require CSRF protection
  return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
  }


  $.ajaxSetup({
      beforeSend: function(xhr, settings) {
          if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
              xhr.setRequestHeader("X-CSRFToken", csrftoken);
          }
      }
  });

  

  var handler = StripeCheckout.configure({
  	
    key: '{{ publish_key }}',
    locale: 'auto',
    token: function(token) {
      // You can access the token ID with `token.id`.
      // Get the token ID to your server-side code for use.
      $.ajax({
	  		url: '{% url "landing_retrieve1" %}',
	  		type: 'POST',
	  		data: {
	  			purchases: JSON.stringify(purchases),
	  			token: token.id,
	  			total: total,
	  		},

	      success: function(data){
          $("#modal_content").html(data['msg']);
          $("#modal_link").trigger('click');
	      },

	      failure: function(data){
          $("#modal_content").html('Something wrong happened, please try again. Thanks!')
          $("#modal_link").trigger('click');
	      }
	  	})
    }
  });

  $('.checkout_button').on('click', function(e) {
    // Open Checkout with further options:
    if(total==0){
			// show loader
			$('#loader-wrapper').show();
			setTimeout(function(){
				$('#loader-wrapper').hide();
			}, 800);    
    	$.ajax({
	  		url: '{% url "landing_retrieve1" %}',
	  		type: 'POST',
	  		data: {
	  			is_download: true,
	  			pk: $('#download_button').attr('name'),
	  		},
	      success: function(data){
	        $("#modal_content").html(data['msg']);
	        $("#modal_link").trigger('click');
	      },
	      failure: function(data){
	        $("#modal_content").html('Something wrong happened, please try again. Thanks!')
	        $("#modal_link").trigger('click');
	      }
    	})
    }else{
    	handler.open({
	      name: 'Bryte Headshot Upgrade',
	      description: 'Bryte Headshot Upgrade',
	      amount: total * 100,
    	});
    }
    e.preventDefault();
  });

  // Close Checkout on page navigation:
  $(window).on('popstate', function() {
    handler.close();
  });


  // sample see more
  $('#sample_see_more_button').click(function(){
  	$('#sample_see_more').fadeOut(200);
  	$('#more_samples').fadeIn(500);
  });

{% endblock %}
